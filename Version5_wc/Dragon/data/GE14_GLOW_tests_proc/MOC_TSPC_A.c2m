*** GE14_ASSEMBLY case with MOC+TSPC solution : 
* BWR LATTICE array based on GE-14 geometry, 
* import tdt_data generated by glow.
* Solve 1 group MOC problem to ensure proper material numbering treatment
* Macroscpic cross sections from GE-14 assembly pins. 
* self-shielded and solved in DRAGON : endfb8r1 - SHEM295
* Homogenized in fuel and condensed to 1 group.


MODULE GEO: MAC: G2S: SALT: MCCGT: ASM: FLU: GREP: DELETE: END: ;
PROCEDURE assertS ;
LINKED_LIST TRACKMOC PIJ SYS FLUX ;

SEQ_BINARY TRACKFILMOC ;
SEQ_ASCII tdt_iso :: FILE 'GE-14_assembly_MOC_TSPC.dat' ;
SEQ_ASCII glow_tiso.ps :: FILE 'GE-14_assembly_MOC_TSPC.ps' ;

REAL keffGEOMOC ;
REAL delCPIC delMOCIC deltak ;

* ---
* TRACKING PARAMTERES
* ---
ECHO "BEGIN GE14_ASSEMBLY MOC+TSPC CASE" ;

! (30, 80.0) works : other values might lead to SALTLC: INVALID SEGMENT LENGTH
! (30, 105.0) : works with max 1% error on tracking volumes.
INTEGER an2d := 30 ;  ! ANGULAR QUADRATURE PARAMETER
REAL densur := 105.0 ; ! DENSITY OF INTEGRATION LINES CM^-1 
glow_tiso.ps := G2S: tdt_iso :: ;

*----
ECHO " --- GLOW CASES TREATMENT --- " ;
*** TREAT ALL GLOW CASES SECOND ***


TRACKMOC TRACKFILMOC := SALT: tdt_iso ::
     EDIT 2
     TITLE "TSPC MOC SURFACIC GE14_A GLOW+MACRO CASE"
     TSPC EQW2 <<an2d>> <<densur>>
     NOIC
     ;

* MOC tracking
TRACKMOC := MCCGT: TRACKMOC TRACKFILMOC ::
  EDIT 0
;


END: ;