*** GE14_ASSEMBLY case with MOC+TSPC solution : 
* BWR LATTICE array based on GE-14 geometry, 
* with control cross case.
* import tdt_data generated by glow.
* Solve 1 group MOC problem to ensure proper material numbering treatment
* Macroscpic cross sections from GE-14 assembly pins. 
* self-shielded and solved in DRAGON : endfb8r1 - SHEM295
* Homogenized in fuel and condensed to 1 group.


MODULE GEO: MAC: G2S: SALT: MCCGT: ASM: FLU: GREP: DELETE: END: ;
PROCEDURE assertS ;
LINKED_LIST TRACKMOC PIJ SYS FLUX ;

SEQ_BINARY TRACKFILMOC ;
SEQ_ASCII tdt_tspc :: FILE 'GE-14_assembly_MOC_TSPC.dat' ;
SEQ_ASCII glow_tspc.ps :: FILE 'GE-14_assembly_MOC_TSPC.ps' ;

SEQ_ASCII tdt_ctrl :: FILE 'GE-14_assembly_ctrl_MOC_TSPC.dat' ;
SEQ_ASCII glow_ctrl.ps :: FILE 'GE-14_assembly_ctrl_MOC_TSPC.ps' ;

REAL keffGEOMOC ;
REAL delCPIC delMOCIC deltak ;

* ---
* TRACKING PARAMTERES
* ---

! (30, 80.0) works : other values might lead to SALTLC: INVALID SEGMENT LENGTH
! (30, 105.0) : works with max 1% error on tracking volumes.
INTEGER an2d := 30 ;  ! ANGULAR QUADRATURE PARAMETER
REAL densur := 150.0 ; ! DENSITY OF INTEGRATION LINES CM^-1 
glow_tspc.ps := G2S: tdt_tspc :: ;

*----
ECHO " --- GLOW CASES TREATMENT --- " ;
*** TREAT ALL GLOW CASES SECOND ***


ECHO "BEGIN GE14_ASSEMBLY MOC+TSPC CASE" ;
TRACKMOC TRACKFILMOC := SALT: tdt_tspc ::
     EDIT 2
     TITLE "TSPC MOC SURFACIC GE14_A GLOW CASE"
     TSPC EQW2 <<an2d>> <<densur>>
     NOIC
     ;

* MOC tracking
TRACKMOC := MCCGT: TRACKMOC TRACKFILMOC ::
  EDIT 2
;

TRACKMOC TRACKFILMOC := DELETE: TRACKMOC TRACKFILMOC ;
ECHO "BEGIN GE14_ASSEMBLY_CTRL MOC+TSPC CASE" ;

glow_ctrl.ps := G2S: tdt_ctrl :: ;
TRACKMOC TRACKFILMOC := SALT: tdt_ctrl ::
     EDIT 2
     TITLE "TSPC MOC SURFACIC GE14_A_CTRL GLOW CASE"
     TSPC EQW2 <<an2d>> <<densur>>
     NOIC
     ;

* MOC tracking
TRACKMOC := MCCGT: TRACKMOC TRACKFILMOC ::
  EDIT 2
;

END: ;