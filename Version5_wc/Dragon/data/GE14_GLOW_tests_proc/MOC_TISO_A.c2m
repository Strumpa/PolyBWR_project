*** GE14_ASSEMBLY case with MOC+TISO solution : 
* BWR LATTICE array based on GE-14 geometry, 
* import tdt_data generated by glow.
* Solve 1 group MOC problem to ensure proper material numbering treatment
* Macroscpic cross sections from GE-14 assembly pins. 
* self-shielded and solved in DRAGON : endfb8r1 - SHEM295
* Homogenized in fuel and condensed to 1 group.


MODULE GEO: MAC: G2S: SALT: MCCGT: ASM: FLU: GREP: DELETE: END: ;
PROCEDURE assertS ;
LINKED_LIST TRACKMOC PIJ SYS FLUX ;

SEQ_BINARY TRACKFILMOC ;
SEQ_ASCII tdt_iso :: FILE 'GE-14_assembly_MOC_TISO.dat' ;
SEQ_ASCII glow_tiso.ps :: FILE 'GE-14_assembly_MOC_TISO.ps' ;
SEQ_ASCII tdt_ctrl :: FILE 'GE-14_assembly_ctrl_MOC_TISO.dat' ;
SEQ_ASCII glow_ctrl.ps :: FILE 'GE-14_assembly_ctrl_MOC_TISO.ps' ;

REAL keffGEOMOC ;
REAL delCPIC delMOCIC deltak ;

* ---
* TRACKING PARAMTERES
* ---
INTEGER an2d := 24 ;  ! ANGULAR QUADRATURE PARAMETER
REAL densur := 100.0 ; ! DENSITY OF INTEGRATION LINES CM^-1
glow_tiso.ps := G2S: tdt_iso :: ;

*----
ECHO " --- GLOW CASES TREATMENT --- " ;
*** TREAT ALL GLOW CASES SECOND ***

ECHO "BEGIN GE14_ASSEMBLY MOC+TISO CASE" ;
TRACKMOC TRACKFILMOC := SALT: tdt_iso ::
     EDIT 2
     TITLE "TISO MOC SURFACIC GE14_A GLOW CASE"
     TISO EQW <<an2d>> <<densur>>
     NOIC
     ;

* MOC tracking
TRACKMOC := MCCGT: TRACKMOC TRACKFILMOC ::
  EDIT 0
;


TRACKMOC TRACKFILMOC := DELETE: TRACKMOC TRACKFILMOC ;
ECHO "BEGIN GE14_ASSEMBLY_CTRL MOC+TISO CASE" ;
glow_ctrl.ps := G2S: tdt_ctrl :: ;

TRACKMOC TRACKFILMOC := SALT: tdt_ctrl ::
     EDIT 2
     TITLE "TISO MOC SURFACIC GE14_A_CTRL GLOW CASE"
     TISO EQW <<an2d>> <<densur>>
     NOIC
     ;

* MOC tracking
TRACKMOC := MCCGT: TRACKMOC TRACKFILMOC ::
  EDIT 10
;


END: ;