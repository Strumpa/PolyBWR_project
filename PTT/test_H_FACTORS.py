H_factors = """
  4.07433408E+08  4.01509216E+08  3.46327136E+08  3.33428736E+08  3.39543136E+08
  3.43620832E+08  3.35026496E+08  2.97640064E+08  2.43353056E+08  2.05042064E+08
  2.16227088E+08  2.25478720E+08  2.36537200E+08  2.45422864E+08  2.49539280E+08
  2.46881744E+08  2.41922048E+08  2.38247952E+08  2.36958544E+08  2.35056912E+08
  2.32947760E+08  2.33771856E+08  2.23963408E+08  2.18302144E+08  2.17768512E+08
  2.21244752E+08  2.23324928E+08  2.31118080E+08  2.32765056E+08  2.38357440E+08
  2.41219952E+08  2.50631424E+08  2.61187792E+08  2.71944352E+08  2.80619328E+08
  2.89128992E+08  2.94829344E+08  3.05918560E+08  3.12204608E+08  3.30405088E+08
  3.52479648E+08  3.62323168E+08  3.63565856E+08  3.68373056E+08  3.56376928E+08
  4.09858240E+08  4.48717856E+08  4.24145728E+08  4.18285056E+08  4.22759328E+08
  4.55214016E+08  4.63993792E+08  4.77518528E+08  5.16583712E+08  5.32924992E+08
  5.88526528E+08  6.03253696E+08  6.62709184E+08  7.68632256E+08  8.81505920E+08
  9.17435648E+08  9.72338176E+08  9.86371200E+08  1.11472000E+09  1.05072173E+09
  1.18060032E+09  1.29602253E+09  1.34872512E+09  1.63126771E+09  1.79149210E+09
  1.28704166E+09  1.56068621E+09  1.62961574E+09  2.01271027E+09  2.32207693E+09
  2.03719040E+09  1.86627827E+09  3.07530650E+09  2.61460992E+09  2.96624102E+09
  2.70852557E+09  3.23286221E+09  2.77190630E+09  3.04702234E+09  2.15704448E+09
  2.12597901E+09  2.24617958E+09  3.43262822E+09  3.53098240E+09  2.18598912E+09
  2.95496397E+09  2.31144730E+09  3.36353510E+09  5.44292813E+09  4.77986765E+09
  3.78362803E+09  3.96178048E+09  4.88170189E+09  5.09379430E+09  2.69156429E+09
  6.11157146E+09  2.80797184E+09  4.26572186E+09  3.96142848E+09  1.42597107E+09
  1.86429888E+09  9.62975232E+08  8.63528000E+08  5.63427533E+09  3.81012634E+09
  4.40027546E+09  3.58309120E+09  3.46444544E+09  3.82534963E+09  5.89877248E+09
  5.14012621E+09  6.37505997E+09  5.26527130E+09  3.22876467E+09  6.55601766E+09
  2.61628211E+09  1.64246899E+09  3.47137818E+09  5.98686618E+09  5.54117325E+09
  1.61109670E+09  1.87343590E+09  2.48699136E+09  3.31515827E+09  3.00338714E+09
  6.46738176E+09  6.23700992E+09  4.31706829E+09  3.16070810E+09  6.85174016E+09
  6.62847693E+09  8.86783590E+09  8.63339776E+08  1.30186547E+09  1.95749773E+09
  2.05577254E+09  1.67203917E+09  9.74714944E+08  1.33973402E+09  3.97753421E+09
  3.01705062E+09  4.83392614E+09  7.43727411E+09  1.70142351E+10  4.14880742E+09
  1.26198938E+10  1.22436915E+10  8.63025971E+09  7.63861965E+09  2.99536768E+09
  8.90292224E+09  5.67744614E+09  4.28427571E+09  8.76281549E+09  5.88549171E+09
  1.47548631E+10  3.43600282E+09  2.06890394E+09  1.78641664E+09  2.27961370E+09
  3.65054131E+09  8.47234253E+09  3.98717542E+10  1.42095012E+10  9.34872371E+09
  3.05726310E+09  8.35916954E+09  1.13697567E+10  1.24181696E+09  3.52481510E+09
  1.47102628E+10  4.13711258E+09  3.56243251E+10  9.32920730E+09  6.37991578E+09
  5.09561088E+09  5.93998643E+09  5.07671194E+09  5.96745165E+09  1.33543752E+10
  4.66807706E+09  2.44961649E+10  1.00170762E+10  6.34333184E+09  2.51436314E+09
  3.46044928E+09  4.94055270E+09  9.49139251E+09  3.34441738E+10  5.38096968E+10
  2.95149824E+09  6.47741248E+08  1.61559514E+09  7.72183347E+09  3.15686016E+09
  1.43918408E+10  7.12116890E+09  3.17011354E+09  2.72526618E+09  1.47774310E+09
  2.39807078E+09  7.48720832E+08  6.23019008E+08  5.94157952E+08  5.66745536E+08
  6.41092160E+08  2.49233203E+09  1.09805640E+10  6.28303104E+09  5.93578445E+09
  3.16148301E+09  2.37346330E+09  2.08739507E+09  1.92170432E+09  1.74986330E+09
  1.70431539E+09  1.72921242E+09  1.78371085E+09  1.87604941E+09  2.00247424E+09
  2.10621709E+09  2.19418982E+09  2.40108006E+09  3.22503219E+09  4.17775334E+09
  3.32144845E+09  2.64511770E+09  2.66935501E+09  2.80295322E+09  2.96169779E+09
  3.20818790E+09  3.50230656E+09  3.75051059E+09  4.17823232E+09  4.87304038E+09
  6.11207066E+09  8.67317555E+09  1.31686625E+10  1.71366564E+10  1.88829061E+10
  1.96369121E+10  1.97917082E+10  1.95979796E+10  1.90944215E+10  1.73461074E+10
  1.54668708E+10  1.46885048E+10  1.40312033E+10  1.33995858E+10  1.27638252E+10
  1.21706844E+10  1.16522803E+10  1.11541484E+10  1.07884442E+10  1.09042637E+10
  1.18481224E+10  1.28891515E+10  1.37213215E+10  1.48325847E+10  1.63971133E+10
  1.87772969E+10  2.21532918E+10  2.67127562E+10  3.15259617E+10  3.50319616E+10
  3.72154040E+10  3.76634737E+10  3.66007255E+10  3.55435356E+10  3.53591296E+10
  3.66212014E+10  3.94748887E+10  4.30272553E+10  4.69842043E+10  5.15681853E+10
  5.69628344E+10  6.30108365E+10  6.95786291E+10  7.66441062E+10  8.41945006E+10
  9.22287309E+10  1.00813603E+11  1.10088577E+11  1.21868394E+11  1.39610063E+11
  1.65306614E+11  1.99850295E+11  2.47080468E+11  3.20321126E+11  5.11768723E+11
  """

NFTOT = """
  2.12014604E+00  2.08611202E+00  1.80684805E+00  1.74072599E+00  1.76963699E+00
  1.78774703E+00  1.74039900E+00  1.54490805E+00  1.26165903E+00  1.05737901E+00
  1.11385298E+00  1.16127098E+00  1.21784699E+00  1.26314795E+00  1.28383303E+00
  1.26966798E+00  1.24378598E+00  1.22464204E+00  1.21791196E+00  1.20798600E+00
  1.19690502E+00  1.20091605E+00  1.15019596E+00  1.12070501E+00  1.11744499E+00
  1.13496006E+00  1.14540601E+00  1.18532205E+00  1.19351602E+00  1.22171700E+00
  1.23537302E+00  1.28272104E+00  1.33582401E+00  1.39009500E+00  1.43383503E+00
  1.47684002E+00  1.50571096E+00  1.56228399E+00  1.59333706E+00  1.68379903E+00
  1.79731905E+00  1.84763002E+00  1.85161901E+00  1.87768400E+00  1.81606698E+00
  2.08914399E+00  2.28786802E+00  2.16362596E+00  2.13428497E+00  2.15438199E+00
  2.31767392E+00  2.36205101E+00  2.42951608E+00  2.62881899E+00  2.71050596E+00
  2.99618793E+00  3.06614804E+00  3.36933899E+00  3.91532803E+00  4.48834276E+00
  4.66511393E+00  4.94576502E+00  5.01991796E+00  5.68249702E+00  5.34287977E+00
  5.99269485E+00  6.60094786E+00  6.86096621E+00  8.30333138E+00  9.09249783E+00
  6.47946119E+00  7.87740421E+00  8.24787045E+00  1.02334499E+01  1.18081703E+01
  1.03754501E+01  9.40269566E+00  1.57490597E+01  1.33289204E+01  1.51303596E+01
  1.37929697E+01  1.64964008E+01  1.41139603E+01  1.55353498E+01  1.09907198E+01
  1.07385998E+01  1.14069700E+01  1.74577503E+01  1.78578796E+01  1.10723495E+01
  1.50871801E+01  1.18387804E+01  1.71798096E+01  2.76446800E+01  2.43662891E+01
  1.92953701E+01  2.02745399E+01  2.45181999E+01  2.59858398E+01  1.34661703E+01
  3.11184998E+01  1.42943897E+01  2.15386009E+01  1.97980309E+01  7.20922279E+00
  9.55737877E+00  4.84013796E+00  4.25628805E+00  2.84565907E+01  1.94417992E+01
  2.23441010E+01  1.79185905E+01  1.74975700E+01  1.93044300E+01  2.96778507E+01
  2.61608200E+01  3.22741585E+01  2.67713909E+01  1.65584393E+01  3.35570488E+01
  1.32820396E+01  8.16892719E+00  1.69989300E+01  3.03768692E+01  2.80318909E+01
  8.11547756E+00  9.33098221E+00  1.23733397E+01  1.68854103E+01  1.48637199E+01
  3.23163300E+01  3.19526291E+01  2.17708607E+01  1.60664997E+01  3.47902107E+01
  3.38462906E+01  4.52627487E+01  4.36495495E+00  6.47037601E+00  9.73596859E+00
  1.02360601E+01  8.32892227E+00  4.88674307E+00  6.48723078E+00  1.95798397E+01
  1.54789600E+01  2.47059803E+01  3.77724419E+01  8.63226700E+01  2.11323605E+01
  6.46545105E+01  6.18916206E+01  4.36209908E+01  3.87927704E+01  1.52683201E+01
  4.54652100E+01  2.85110207E+01  2.11907501E+01  4.34916115E+01  2.99707298E+01
  7.42720184E+01  1.75652199E+01  1.06086197E+01  9.15582275E+00  1.16857405E+01
  1.87060204E+01  4.33541718E+01  2.02600601E+02  7.04837875E+01  4.69731216E+01
  1.53105402E+01  4.27960205E+01  5.69523010E+01  6.23122978E+00  1.73911991E+01
  7.26186295E+01  2.08438091E+01  1.79932602E+02  4.71990891E+01  3.25106087E+01
  2.59797306E+01  2.93495693E+01  2.55769291E+01  3.02346706E+01  6.84933395E+01
  2.37595596E+01  1.21517799E+02  4.86897011E+01  2.91255398E+01  1.28273497E+01
  1.76454201E+01  2.50831108E+01  4.84129601E+01  1.70386703E+02  2.73910889E+02
  1.49264202E+01  3.20478296E+00  7.98094177E+00  3.83903885E+01  1.51404495E+01
  6.85342102E+01  3.58581810E+01  1.61764107E+01  1.39093800E+01  7.22403383E+00
  1.04648104E+01  3.69936395E+00  3.12270498E+00  2.98006701E+00  2.83457708E+00
  3.18313193E+00  1.24648504E+01  5.54258385E+01  3.19458408E+01  3.03132896E+01
  1.61602402E+01  1.21039104E+01  1.06341600E+01  9.78476810E+00  8.90891361E+00
  8.68280602E+00  8.81494045E+00  9.09930229E+00  9.57720089E+00  1.02241001E+01
  1.07441397E+01  1.11717796E+01  1.21512699E+01  1.60046501E+01  2.04759102E+01
  1.65453606E+01  1.34497499E+01  1.36242704E+01  1.43118296E+01  1.51208000E+01
  1.63736897E+01  1.78674603E+01  1.91267605E+01  2.12917099E+01  2.47981796E+01
  3.10619202E+01  4.40780983E+01  6.70331879E+01  8.73669205E+01  9.63577423E+01
  1.00272903E+02  1.01114998E+02  1.00169403E+02  9.76386566E+01  8.87709198E+01
  7.92076035E+01  7.52394028E+01  7.18862991E+01  6.86625671E+01  6.54161987E+01
  6.23862381E+01  5.97371483E+01  5.71910591E+01  5.53223610E+01  5.59196281E+01
  6.07586784E+01  6.60939178E+01  7.03576965E+01  7.60501175E+01  8.40613785E+01
  9.62422333E+01  1.13504204E+02  1.36790894E+02  1.61341293E+02  1.79197906E+02
  1.90292801E+02  1.92538605E+02  1.87115799E+02  1.81763107E+02  1.80889297E+02
  1.87434494E+02  2.02122101E+02  2.20368301E+02  2.40675598E+02  2.64190308E+02
  2.91855103E+02  3.22863098E+02  3.56528992E+02  3.92738403E+02  4.31424194E+02
  4.72579010E+02  5.16543396E+02  5.64031006E+02  6.24332520E+02  7.15147522E+02
  8.46698975E+02  1.02358899E+03  1.26549805E+03  1.64067395E+03  2.62138892E+03
  """


## Split H_FACTORS and NFTOT in group-wise quantities,

H_factors_list = [float(x) for x in H_factors.strip().split()]
NFTOT_list = [float(x) for x in NFTOT.strip().split()]

## compute H-FACTOR / NFTOT and check if every group has Q = H-FACTOR / NFTOT = MF3/MT18 ~ Recoverable energy --> constant in energy.

ratio = [H_factors_list[i] * 1e-6 / NFTOT_list[i] for i in range(len(H_factors_list))]

## If H-FACTOR / NFTOT constant in energy : self-shielding of NFTOT induces variations in deposited energy so "reconstructed Q" is not valid? 

print(ratio)
# compute average ratio
avg_ratio = sum(ratio) / len(ratio)
print(f"Average ratio H-FACTOR / NFTOT = {avg_ratio}")
for i in range(len(ratio)-1):
    diff = abs(ratio[i+1] - ratio[i])/ratio[i]
    assert diff < 1e-6, f"Ratio H-FACTOR / NFTOT not constant in energy: diff between group {i} and {i+1} = {diff}"